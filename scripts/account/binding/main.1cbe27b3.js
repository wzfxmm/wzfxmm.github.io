define("domReady",[],function(){"use strict";function a(a){var b;for(b=0;b<a.length;b+=1)a[b](j)}function b(){var b=k;i&&b.length&&(k=[],a(b))}function c(){i||(i=!0,g&&clearInterval(g),$(".page-loading")&&$(".page-loading").hide(),b())}function d(a){return i?a(j):k.push(a),d}var e,f,g,h="undefined"!=typeof window&&window.document,i=!h,j=h?document:null,k=[];if(h){if(document.addEventListener)document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1);else if(window.attachEvent){window.attachEvent("onload",c),f=document.createElement("div");try{e=null===window.frameElement}catch(a){}f.doScroll&&e&&window.external&&(g=setInterval(function(){try{f.doScroll(),c()}catch(a){}},30))}"complete"===document.readyState&&c()}return d.version="2.0.1",d.load=function(a,b,c,e){e.isBuild?c(null):d(c)},d}),define("text",{}),define("json",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("json!config.json",function(){return{isDebug:!1,env:"mock",mockAppId:null,mockDomain:"http://127.0.0.1",mockPort:6003,mockPath:null,ver:1.1,channel:"1",timeout:1e4,delayHide:5e3,cliHttpErrorMsg:"请求错误",cliTimeoutMsg:"连接超时请检查网络设置",bizSystemMsg:"系统异常请稍后再试",bizAuthMsg:"登录状态无效,请重新登录",cryptErrorMsg:"加解密时发生错误",signErrorMsg:"验证签名时发生错误",tokenKey:"__t__",openId:"__o__",loadingStr:"请稍后...",postMethod:"POST",getMethod:"GET",enterTimeout:300,leaveTimeout:300}}),function(a){a("util",["json!config.json"],function(a){function b(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null}function c(a){return!(null!=a&&a.length>0)}function d(a){function b(a){for(var b={},c=a.split("&"),d=0;null!=c&&d<c.length;d++){var e=c[d].split("=");b[e[0]]=decodeURIComponent(e[1])}return b}$("#"+a).attr("onsubmit","return false");var c=$("#"+a).serialize();c=c.replace(/\+/g," ");var d=JSON.stringify(b(c)),e=JSON.parse(d);return e}function e(a,b){if(b)var c=/\w{1,}\.html{1}\?{1}/,d=c.test(a)?"&returnurl="+encodeURIComponent(encodeURIComponent(b)):"?returnurl="+encodeURIComponent(encodeURIComponent(b));location.href=a+d}function f(){var a=b("returnurl");if(a)return void(location.href=decodeURIComponent(a))}function g(b){b.length<=13?h({content:b,stayTime:a.delayHide,type:"info"}):i({title:"提示信息",content:b,button:["确认"]})}var h=require("tips"),i=require("dialog");return{getQueryString:b,isEmpty:c,queryParamByFormId:d,pageForward:e,backReturnUrl:f,notice:g}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("oauthUtil",["json!config.json","util"],function(a,b){var c=require("store"),d=require("blankPage"),e=function(e){var f=b.getQueryString("openid");b.isEmpty(f)?d({title:"该页面只能在微信设备终端中打开",button:!1}):(c.set(a.openId,$.trim(f)),e())},f=function(){return c.get(a.openId)};return{init:e,getOpenId:f}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("transformHandler",["json!config.json"],function(a){function b(b){a.isDebug||"prod"===a.env||0,a.isDebug&&"prod"!==a.env&&alert(b)}function c(a){return null===a?"":a}function d(b){try{if(0===b.entity.payload.code&&b.entity.header.token){var c=g.get(a.tokenKey);c!=b.entity.header.token&&g.set(a.tokenKey,$.trim(b.entity.header.token))}}catch(a){return h.reject({response:b,error:"storeerror"})}}function e(b,d){if("mock"!=a.env&&"test"!=a.env&&"prod"!=a.env&&"machine"!=a.env&&"simulate"!=a.env)throw 0,new Error("环境变量定义错误");var e=a.env+"Path",f=a.env+"Domain",h=a.env+"Port";a[e]=c(a[e]);var i="";i+=a[f],i+=null==a[h]||"80"==a[h]?"":":"+a[h],i+=0===a[e].indexOf("/")?a[e]:"/"+a[e],"mock"!=a.env&&"machine"!=a.env||(i+=d.funcNo),b.path=i;var j={header:{appId:a[a.env+"AppId"],ver:a.ver+"",channel:a.channel,funcNo:d.funcNo,timestamp:(new Date).getTime()},payload:b.entity,sign:""},k=g.get(a.tokenKey);return k&&(j.header.token=k),b.entity=j,b}var f=require("httpClient/interceptor"),g=require("store"),h=require("when"),i=require("loading");return f({init:function(a){return a},request:function(c,d){var f=e(c,d);return"prod"!==a.env&&b("[request]->["+d.funcNo+"]"+JSON.stringify(f)),"IF030002"!=d.funcNo&&(d.loading=i({content:a.loadingStr})),f},response:function(c,e){if("prod"!==a.env){var f={};f.entity=c.entity,f.httpStatus=c.status,b("[response]<-["+e.funcNo+"]"+JSON.stringify(f))}if(e.loading&&e.loading.loading("hide"),c.error)return c;d(c);var h=c.entity.header.state;return"boolean"==typeof h&&g.set("__s__",h),c}})})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("securityHandler",["json!config.json"],function(a){var b,c,d,e=require("httpClient/interceptor"),f=require("when");if("prod"===a.env||"simulate"===a.env||"test"===a.env){var b=require("rsaAlgorithm"),c=new b,d=a[a.env+"PublicRsaKey"];if(void 0==d)throw 0,new Error("PublicRsaKey is lost");c.setPublicKey(a[a.env+"PublicRsaKey"])}var g=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})};return e({init:function(a){return a},request:function(b,d){try{var e=g(),h=c.encrypt(e);d.rc4keyHex=CryptoJS.enc.Hex.parse(e);var i=CryptoJS.RC4.encrypt(b.entity,d.rc4keyHex).ciphertext.toString(),j=CryptoJS.MD5(i+a[a.env+"AppSecret"]);b.rawEntity=b.entity;var k={key:h,content:i,sign:j.toString()};return b.entity=JSON.stringify(k),b}catch(a){return f.reject({response:b,error:"encrypterror"})}},response:function(b,c){try{if(b.error)return b;var d=b.entity&&"object"==typeof b.entity?b.entity:JSON.parse(b.entity),e=CryptoJS.MD5(d.content+a[a.env+"AppSecret"]).toString();if(e!==d.sign)return f.reject({response:b,error:"signerror"});var g={};g.ciphertext=CryptoJS.enc.Hex.parse(d.content);var h=CryptoJS.RC4.decrypt(g,c.rc4keyHex).toString(CryptoJS.enc.Utf8);return b.rawEntity=b.entity,b.entity=h,b}catch(a){return f.reject({response:b,error:"encrypterror"})}}})})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("OBapi",["transformHandler","json!config.json","util","securityHandler"],function(a,b,c,d){var e=require("httpClient"),f=require("httpClient/interceptor/mimeHandler"),g=require("httpClient/interceptor/timeoutHandler"),h=require("httpClient/interceptor/errorcodeHandler"),i=require("when"),j=require("httpClient/util/responsePromise"),k=require("tips"),l=require("dialog"),m=require("store"),n={autoTip:!0};(function(){/content/.test(window.location.search)&&(sessionStorage.content=c.getQueryString("content"))})();return function(o,p,q){var r=$.extend(n,q);return i.attempt(function(a){return a&&"object"==typeof a?a:JSON.parse(a)},p).otherwise(function(){throw"中台消息体序列化时发生错误"}).then(function(i){var n=e.addInterceptor(h);return n=n.addInterceptor(g,{timeout:b.timeout}),"prod"!==b.env&&"simulate"!==b.env&&"test"!==b.env||(n=n.addInterceptor(d)),n=n.addInterceptor(f,{mime:"application/json"}),n=n.addInterceptor(a,{funcNo:o}),j.promise(function(a,d){n({method:"POST",entity:i,headers:{"Content-Type":"application/json"}}).then(function(e){var f=e.entity.payload.data;if("undefined"!=typeof f?(f.state=e.entity.header.state,f.code=e.entity.payload.code,f.info=e.entity.payload.info):f={state:e.entity.header.state,code:e.entity.payload.code,info:e.entity.payload.info},0===e.entity.payload.code)a(f);else if(e.entity.payload.code>=1e3&&e.entity.payload.code<=1999)k({content:b.bizSystemMsg,stayTime:b.delayHide,type:"warn"}),d(f);else if(e.entity.payload.code>=3e3&&e.entity.payload.code<=3019){m.remove(b.tokenKey);var g={title:"提示信息",content:b.bizAuthMsg};e.entity.payload.code>=3001&&(g.content=e.entity.payload.info);var h=l(g);h.on("dialog:action",function(a){c.pageForward("login.html",location.href)}),d(f)}else if(0!==e.entity.payload.code){var i=e.entity.payload.info;r.autoTip&&c.notice(i),d(f)}else d(f)}).otherwise(function(a){k("httperror"===a.error?{content:b.cliHttpErrorMsg,stayTime:b.delayHide,type:"warn"}:"timeout"===a.error?{content:b.cliTimeoutMsg,stayTime:b.delayHide,type:"warn"}:"encrypterror"===a.error?{content:b.cryptErrorMsg,stayTime:b.delayHide,type:"warn"}:"signerror"===a.error?{content:b.signErrorMsg,stayTime:b.delayHide,type:"warn"}:{content:b.bizSystemMsg,stayTime:b.delayHide,type:"warn"}),d(a)})})})}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080002",["OBapi"],function(a){var b=function(b){var c={openId:b};return a("IF080002",c)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("accountBindingViewModel",["IF080002"],function(a){var b="initBindBranch",c="noInitBindBranch",d={openId:""};return d.pushViewController=function(){var d=this;return new a(d.openId).then(function(a){if(a.accounts.length>0){for(var d=!1,e=0;e<a.accounts.length;e++){var f=a.accounts[e];if("1"===f.isBindWechat){d=!0;break}}return d?a.branch=c:a.branch=b,a}return a.branch=b,a})},{viewModel:d,initBindBranch:b,noInitBindBranch:c}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("regexBuilder",[],function(){var a=function(){this._flags="",this._literal=[],this._groupsUsed=0,this._clear()},b=a.prototype;b._clear=function(){this._min=-1,this._max=-1,this._of="",this._ofAny=!1,this._ofGroup=-1,this._from="",this._notFrom="",this._like="",this._either="",this._reluctant=!1,this._capture=!1},b._flushState=function(){if(""!=this._of||this._ofAny||this._ofGroup>0||""!=this._from||""!=this._notFrom||""!=this._like){var a=this._capture?"":"?:",b=this._getQuantityLiteral(),c=this._getCharacterLiteral(),d=this._reluctant?"?":"";this._literal.push("("+a+"(?:"+c+")"+b+d+")"),this._clear()}},b._getQuantityLiteral=function(){return this._min!=-1?this._max!=-1?"{"+this._min+","+this._max+"}":"{"+this._min+",}":"{0,"+this._max+"}"},b._getCharacterLiteral=function(){return""!=this._of?this._of:this._ofAny?".":this._ofGroup>0?"\\"+this._ofGroup:""!=this._from?"["+this._from+"]":""!=this._notFrom?"[^"+this._notFrom+"]":""!=this._like?this._like:void 0},b.getLiteral=function(){return this._flushState(),this._literal.join("")},b._combineGroupNumberingAndGetLiteral=function(a){var b=this._incrementGroupNumbering(a.getLiteral(),this._groupsUsed);return this._groupsUsed+=a._groupsUsed,b},b._incrementGroupNumbering=function(a,b){return b>0&&(a=a.replace(/[^\\]\\\d+/g,function(a){var c=parseInt(a.substring(2))+b;return a.substring(0,2)+c})),a},b.getRegExp=function(){return this._flushState(),new RegExp(this._literal.join(""),this._flags)},b._addFlag=function(a){return this._flags.indexOf(a)==-1&&(this._flags+=a),this},b.ignoreCase=function(){return this._addFlag("i")},b.multiLine=function(){return this._addFlag("m")},b.globalMatch=function(){return this._addFlag("g")},b.startOfInput=function(){return this._literal.push("(?:^)"),this},b.startOfLine=function(){return this.multiLine(),this.startOfInput()},b.endOfInput=function(){return this._flushState(),this._literal.push("(?:$)"),this},b.endOfLine=function(){return this.multiLine(),this.endOfInput()},b.either=function(b){return"string"==typeof b?this._eitherLike((new a).exactly(1).of(b)):this._eitherLike(b)},b._eitherLike=function(a){return this._flushState(),this._either=this._combineGroupNumberingAndGetLiteral(a),this},b.or=function(b){return"string"==typeof b?this._orLike((new a).exactly(1).of(b)):this._orLike(b)},b._orLike=function(a){var b=this._either,c=this._combineGroupNumberingAndGetLiteral(a);if(""==b){var d=this._literal[this._literal.length-1];d=d.substring(0,d.length-1),this._literal[this._literal.length-1]=d,this._literal.push("|(?:"+c+"))")}else this._literal.push("(?:(?:"+b+")|(?:"+c+"))");return this._clear(),this},b.neither=function(b){return"string"==typeof b?this.notAhead((new a).exactly(1).of(b)):this.notAhead(b)},b.nor=function(a){return 0==this._min&&this._ofAny&&(this._min=-1,this._ofAny=!1),this.neither(a),this.min(0).ofAny()},b.exactly=function(a){return this._flushState(),this._min=a,this._max=a,this},b.min=function(a){return this._flushState(),this._min=a,this},b.max=function(a){return this._flushState(),this._max=a,this},b.of=function(a){return this._of=this._sanitize(a),this},b.ofAny=function(){return this._ofAny=!0,this},b.ofGroup=function(a){return this._ofGroup=a,this},b.from=function(a){return this._from=this._sanitize(a.join("")),this},b.notFrom=function(a){return this._notFrom=this._sanitize(a.join("")),this},b.like=function(a){return this._like=this._combineGroupNumberingAndGetLiteral(a),this},b.reluctantly=function(){return this._reluctant=!0,this},b.ahead=function(a){return this._flushState(),this._literal.push("(?="+this._combineGroupNumberingAndGetLiteral(a)+")"),this},b.notAhead=function(a){return this._flushState(),this._literal.push("(?!"+this._combineGroupNumberingAndGetLiteral(a)+")"),this},b.asGroup=function(){return this._capture=!0,this._groupsUsed++,this},b.then=function(a){return this.exactly(1).of(a)},b.find=function(a){return this.then(a)},b.some=function(a){return this.min(1).from(a)},b.maybeSome=function(a){return this.min(0).from(a)},b.maybe=function(a){return this.max(1).of(a)},b.something=function(){return this.min(1).ofAny()},b.anything=function(){return this.min(0).ofAny()},b.anythingBut=function(b){return 1==b.length?this.min(0).notFrom([b]):(this.notAhead((new a).exactly(1).of(b)),this.min(0).ofAny())},b.any=function(){return this.exactly(1).ofAny()},b.lineBreak=function(){return this._flushState(),this._literal.push("(?:\\r\\n|\\r|\\n)"),this},b.lineBreaks=function(){return this.like((new a).lineBreak())},b.whitespace=function(){return this._min==-1&&this._max==-1?(this._flushState(),this._literal.push("(?:\\s)"),this):(this._like="\\s",this)},b.notWhitespace=function(){return this._min==-1&&this._max==-1?(this._flushState(),this._literal.push("(?:\\S)"),this):(this._like="\\S",this)},b.tab=function(){return this._flushState(),this._literal.push("(?:\\t)"),this},b.tabs=function(){return this.like((new a).tab())},b.digit=function(){return this._flushState(),this._literal.push("(?:\\d)"),this},b.notDigit=function(){return this._flushState(),this._literal.push("(?:\\D)"),this},b.digits=function(){return this.like((new a).digit())},b.notDigits=function(){return this.like((new a).notDigit())},b.letter=function(){return this.exactly(1),this._from="A-Za-z",this},b.notLetter=function(){return this.exactly(1),this._notFrom="A-Za-z",this},b.letters=function(){return this._from="A-Za-z",this},b.notLetters=function(){return this._notFrom="A-Za-z",this},b.lowerCaseLetter=function(){return this.exactly(1),this._from="a-z",this},b.lowerCaseLetters=function(){return this._from="a-z",this},b.upperCaseLetter=function(){return this.exactly(1),this._from="A-Z",this},b.upperCaseLetters=function(){return this._from="A-Z",this},b.append=function(a){return this.exactly(1),this._like=this._combineGroupNumberingAndGetLiteral(a),this},b.optional=function(a){return this.max(1),this._like=this._combineGroupNumberingAndGetLiteral(a),this},b._sanitize=function(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")};var c={};return c.ignoreCase=function(){return(new a).ignoreCase()},c.multiLine=function(){return(new a).multiLine()},c.globalMatch=function(){return(new a).globalMatch()},c.startOfInput=function(){return(new a).startOfInput()},c.startOfLine=function(){return(new a).startOfLine()},c.endOfInput=function(){return(new a).endOfInput()},c.endOfLine=function(){return(new a).endOfLine()},c.either=function(b){return(new a).either(b)},c.neither=function(b){return(new a).neither(b)},c.exactly=function(b){return(new a).exactly(b)},c.min=function(b){return(new a).min(b)},c.max=function(b){return(new a).max(b)},c.ahead=function(b){return(new a).ahead(b)},c.notAhead=function(b){return(new a).notAhead(b)},c.then=function(b){return(new a).then(b)},c.find=function(b){return(new a).find(b)},c.some=function(b){return(new a).some(b)},c.maybeSome=function(b){return(new a).maybeSome(b)},c.maybe=function(b){return(new a).maybe(b)},c.anything=function(){return(new a).anything()},c.anythingBut=function(b){return(new a).anythingBut(b)},c.any=function(){return(new a).any()},c.lineBreak=function(){return(new a).lineBreak()},c.whitespace=function(){return(new a).whitespace()},c.notWhitespace=function(){return(new a).notWhitespace()},c.tab=function(){return(new a).tab()},c.digit=function(){return(new a).digit()},c.notDigit=function(){return(new a).notDigit()},c.letter=function(){return(new a).letter()},c.notLetter=function(){return(new a).notLetter()},c.lowerCaseLetter=function(){return(new a).lowerCaseLetter()},c.upperCaseLetter=function(){return(new a).upperCaseLetter()},c.append=function(b){return(new a).append(b)},c.optional=function(b){return(new a).optional(b)},c})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("checkFundAccount",["regexBuilder"],function(a){return function(b){return a.startOfLine().min(8).max(8).digits().endOfLine().getRegExp().test(b)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("checkTradePassword",["regexBuilder"],function(a){return function(b){return a.startOfLine().min(6).max(8).ofAny().endOfLine().getRegExp().test(b)}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080001",["OBapi"],function(a){var b=function(b,c,d,e,f){var g={accountType:""==b?"0":b,account:c,password:d,openId:e,bindType:f};return a("IF080001",g)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080014",["OBapi"],function(a){var b=function(b,c,d,e){var f={accountType:""==b?"0":b,account:c,password:d,openId:e};return a("IF080014",f)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("accountInitViewModel",["oauthUtil","checkFundAccount","checkTradePassword","IF080001","IF080014"],function(a,b,c,d,e){var f="occupiedBindBranch",g="toBindBranch",h=require("when"),i=function(){},j={fundAccount:"",password:"",isRead:[]};return j.checkForm=function(a){var d=this;b(d.fundAccount)&&c(d.password)&&d.isRead.length>0?"function"==typeof a?a.call(this,!0):i:"function"==typeof a?a.call(this,!1):i},j.initBindEvt=function(){var b=this,c=new e("0",b.fundAccount,b.password,a.getOpenId()).then(function(a){return a.result?(a.branch=f,h.reject(a)):h.resolve(a)}).then(function(c){return new d("0",b.fundAccount,b.password,a.getOpenId(),"0").then(function(a){return a.branch=g,h.resolve(a)})});return c},{viewModel:j,occupiedBindBranch:f,toBindBranch:g}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("accountInitViewController",["accountInitViewModel","OBapi"],function(a,b){var c=require("keyBoard"),d=require("passGuard"),e=require("dialog"),f=function(a){a?$("#btnConfirm").attr("disabled",null):$("#btnConfirm").attr("disabled","disabled")};return{url:"/",className:"init",render:function(){return $("#tpl_init").html()},bind:function(){Bind(a,{"viewModel.fundAccount":{dom:"#txtFundAccount",callback:function(a){this.checkForm(f)}},"viewModel.isRead":{dom:'input[name="isRead"]',callback:function(a){this.checkForm(f)}}});var g=d({maxLength:8,displayMode:0,httpClient:b}),h=c({kbType:0});g.build("txtPassword",h),h.jq().on("keyboard:pressed",function(){a.viewModel.password=g.getOutput(),a.viewModel.checkForm(f)}),$("#btnConfirm").on("click",function(b){a.viewModel.initBindEvt().then(function(b){b.branch===a.toBindBranch&&(location.href="#/init/result")}).otherwise(function(b){if(b.branch===a.occupiedBindBranch){var c=e({title:"提示",content:"您有同名资金账户存在绑定关系,绑定时使用微信昵称XX。如您选择继续,所有已绑定账户将被解绑",button:["取消","继续绑定"]});c.on("dialog:action",function(a){0})}})})}}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("accountInitResultViewModel",[],function(){return{fundAccount:{f:"crixusshen"}}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("accountInitResultViewController",["accountInitResultViewModel"],function(a){return{url:"/init/result",className:"result",render:function(){return $("#tpl_result").html()},bind:function(){Bind(a,{"fundAccount.f":"#lblFundAccount"})}}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),require(["domReady","json!config.json","oauthUtil","accountBindingViewModel","accountInitViewController","accountInitResultViewController"],function(a,b,c,d,e,f){var g=require("router"),h=require("blankPage");a(function(){c.init(function(){d.viewModel.pushViewController().then(function(a){var c=new g({container:".container",enterTimeout:b.enterTimeout,leaveTimeout:b.leaveTimeout});a.branch===d.initBindBranch?c.push(e).push(f).setDefault("/").init():a.branch===d.noInitBindBranch&&0}).otherwise(function(a){var b=h({title:"未知异常(0X00001)"});b.on("blankPage:action",function(a){b.remove(),location.reload()})})})})}),define("modules/account/binding/viewController",function(){});