define("domReady",[],function(){"use strict";function a(a){var b;for(b=0;b<a.length;b+=1)a[b](j)}function b(){var b=k;i&&b.length&&(k=[],a(b))}function c(){i||(i=!0,g&&clearInterval(g),$(".page-loading")&&($(".page-loading").css("opacity","0"),setTimeout(function(){$(".page-loading").remove()},700)),b())}function d(a){return i?a(j):k.push(a),d}var e,f,g,h="undefined"!=typeof window&&window.document,i=!h,j=h?document:null,k=[];if(h){if(document.addEventListener)document.addEventListener("DOMContentLoaded",c,!1),window.addEventListener("load",c,!1);else if(window.attachEvent){window.attachEvent("onload",c),f=document.createElement("div");try{e=null===window.frameElement}catch(a){}f.doScroll&&e&&window.external&&(g=setInterval(function(){try{f.doScroll(),c()}catch(a){}},30))}"complete"===document.readyState&&c()}return d.version="2.0.1",d.load=function(a,b,c,e){e.isBuild?c(null):d(c)},d}),define("text",{}),define("json",{load:function(a){throw new Error("Dynamic load not allowed: "+a)}}),define("json!config.json",function(){return{isDebug:!1,env:"mock",mockAppId:null,mockDomain:"http://127.0.0.1",mockPort:6003,mockPath:null,ver:1.1,channel:"1",timeout:1e4,delayHide:5e3,cliHttpErrorMsg:"请求错误",cliTimeoutMsg:"连接超时请检查网络设置",bizSystemMsg:"系统异常请稍后再试",bizAuthMsg:"登录状态无效,请重新登录",cryptErrorMsg:"加解密时发生错误",signErrorMsg:"验证签名时发生错误",tokenKey:"__t__",wxKey:"__k__",wxInfo:"__o__",loadingStr:"请稍后...",postMethod:"POST",getMethod:"GET",enterTimeout:300,leaveTimeout:300,accountBindFormURI:"/",accountBindListURI:"/",accountBindResultURI:"/result",accountBindURI:"/bind/:id"}}),function(a){a("util",["json!config.json"],function(a){function b(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)","i"),c=window.location.search.substr(1).match(b);return null!=c?unescape(c[2]):null}function c(a){return!(null!=a&&a.length>0)}function d(a){function b(a){for(var b={},c=a.split("&"),d=0;null!=c&&d<c.length;d++){var e=c[d].split("=");b[e[0]]=decodeURIComponent(e[1])}return b}$("#"+a).attr("onsubmit","return false");var c=$("#"+a).serialize();c=c.replace(/\+/g," ");var d=JSON.stringify(b(c)),e=JSON.parse(d);return e}function e(a,b){if(b)var c=/\w{1,}\.html{1}\?{1}/,d=c.test(a)?"&returnurl="+encodeURIComponent(encodeURIComponent(b)):"?returnurl="+encodeURIComponent(encodeURIComponent(b));location.href=a+d}function f(){var a=b("returnurl");if(a)return void(location.href=decodeURIComponent(a))}function g(b){b.length<=13?h({content:b,stayTime:a.delayHide,type:"info"}):i({title:"提示信息",content:b,button:["确认"]})}var h=require("tips"),i=require("dialog");return{getQueryString:b,isEmpty:c,queryParamByFormId:d,pageForward:e,backReturnUrl:f,notice:g}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("oauthUtil",["json!config.json","util"],function(a,b){var c=require("store"),d=require("blankPage"),e="openid",f="orientsec",g="",h=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})},i=function(g){try{if(!b.getQueryString(e))throw new Error("微信公众标识符获取失败");var i,j={openid:b.getQueryString(e)};i=h();var k=CryptoJS.RC4.encrypt(JSON.stringify(j),CryptoJS.enc.Hex.parse(i)).ciphertext.toString(),l={content:k,sign:i},m=CryptoJS.RC4.encrypt(JSON.stringify(l),CryptoJS.enc.Hex.parse(f)).ciphertext.toString();c.set(a.wxInfo,m),g()}catch(a){var n=d({title:a.message,button:!0});n.on("blankPage:action",function(a){n.remove(),location.reload()})}},j=function(){try{if(""==g){var b={};b.ciphertext=CryptoJS.enc.Hex.parse(c.get(a.wxInfo));var d=CryptoJS.RC4.decrypt(b,CryptoJS.enc.Hex.parse(f)).toString(CryptoJS.enc.Utf8);d=JSON.parse(d),b={},b.ciphertext=CryptoJS.enc.Hex.parse(d.content);var e=CryptoJS.RC4.decrypt(b,CryptoJS.enc.Hex.parse(d.sign)).toString(CryptoJS.enc.Utf8);d=null,b=null,g=JSON.parse(e)}return g}catch(a){throw a}};return{entry:i,getInfo:j}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("notificationUtil",[],function(){var a=function(a,b){$(document).on(a,b)},b=function(a,b){$(document).trigger(a,b)};return{addObserver:a,postNotification:b}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("transformHandler",["json!config.json"],function(a){function b(b){a.isDebug||"prod"===a.env||console.log(b),a.isDebug&&"prod"!==a.env&&alert(b)}function c(a){return null===a?"":a}function d(b){try{if(0===b.entity.payload.code&&b.entity.header.token){var c=g.get(a.tokenKey);c!=b.entity.header.token&&g.set(a.tokenKey,$.trim(b.entity.header.token))}}catch(a){return h.reject({response:b,error:"storeerror"})}}function e(b,d){if("mock"!=a.env&&"test"!=a.env&&"prod"!=a.env&&"machine"!=a.env&&"simulate"!=a.env)throw console.error("环境变量定义错误"),new Error("环境变量定义错误");var e=a.env+"Path",f=a.env+"Domain",h=a.env+"Port";a[e]=c(a[e]);var i="";i+=a[f],i+=null==a[h]||"80"==a[h]?"":":"+a[h],i+=0===a[e].indexOf("/")?a[e]:"/"+a[e],"mock"!=a.env&&"machine"!=a.env||(i+=d.funcNo),b.path=i;var j={header:{appId:a[a.env+"AppId"],ver:a.ver+"",channel:a.channel,funcNo:d.funcNo,timestamp:(new Date).getTime()},payload:b.entity,sign:""},k=g.get(a.tokenKey);return k&&(j.header.token=k),b.entity=j,b}var f=require("httpClient/interceptor"),g=require("store"),h=require("when");require("loading");return f({init:function(a){return a},request:function(c,d){var f=e(c,d);return"prod"!==a.env&&b("[request]->["+d.funcNo+"]"+JSON.stringify(f)),f},response:function(c,e){if("prod"!==a.env){var f={};f.entity=c.entity,f.httpStatus=c.status,b("[response]<-["+e.funcNo+"]"+JSON.stringify(f))}if(e.loading&&e.loading.loading("hide"),c.error)return c;d(c);var h=c.entity.header.state;return"boolean"==typeof h&&g.set("__s__",h),c}})})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("securityHandler",["json!config.json"],function(a){var b,c,d,e=require("httpClient/interceptor"),f=require("when");if("prod"===a.env||"simulate"===a.env||"test"===a.env){var b=require("rsaAlgorithm"),c=new b,d=a[a.env+"PublicRsaKey"];if(void 0==d)throw console.error("PublicRsaKey is lost"),new Error("PublicRsaKey is lost");c.setPublicKey(a[a.env+"PublicRsaKey"])}var g=function(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0,c="x"==a?b:3&b|8;return c.toString(16)})};return e({init:function(a){return a},request:function(b,d){try{var e=g(),h=c.encrypt(e);d.rc4keyHex=CryptoJS.enc.Hex.parse(e);var i=CryptoJS.RC4.encrypt(b.entity,d.rc4keyHex).ciphertext.toString(),j=CryptoJS.MD5(i+a[a.env+"AppSecret"]);b.rawEntity=b.entity;var k={key:h,content:i,sign:j.toString()};return b.entity=JSON.stringify(k),b}catch(a){return f.reject({response:b,error:"encrypterror"})}},response:function(b,c){try{if(b.error)return b;var d=b.entity&&"object"==typeof b.entity?b.entity:JSON.parse(b.entity),e=CryptoJS.MD5(d.content+a[a.env+"AppSecret"]).toString();if(e!==d.sign)return f.reject({response:b,error:"signerror"});var g={};g.ciphertext=CryptoJS.enc.Hex.parse(d.content);var h=CryptoJS.RC4.decrypt(g,c.rc4keyHex).toString(CryptoJS.enc.Utf8);return b.rawEntity=b.entity,b.entity=h,b}catch(a){return f.reject({response:b,error:"encrypterror"})}}})})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("OBapi",["transformHandler","json!config.json","util","securityHandler"],function(a,b,c,d){var e=require("httpClient"),f=require("httpClient/interceptor/mimeHandler"),g=require("httpClient/interceptor/timeoutHandler"),h=require("httpClient/interceptor/errorcodeHandler"),i=require("when"),j=require("httpClient/util/responsePromise"),k=require("tips"),l=require("dialog"),m=require("store"),n={autoTip:!0};(function(){/content/.test(window.location.search)&&(sessionStorage.content=c.getQueryString("content"))})();return function(o,p,q){var r=$.extend(n,q);return i.attempt(function(a){return a&&"object"==typeof a?a:JSON.parse(a)},p).otherwise(function(){throw"中台消息体序列化时发生错误"}).then(function(i){var n=e.addInterceptor(h);return n=n.addInterceptor(g,{timeout:b.timeout}),"prod"!==b.env&&"simulate"!==b.env&&"test"!==b.env||(n=n.addInterceptor(d)),n=n.addInterceptor(f,{mime:"application/json"}),n=n.addInterceptor(a,{funcNo:o}),j.promise(function(a,d){n({method:"POST",entity:i,headers:{"Content-Type":"application/json"}}).then(function(e){var f=e.entity.payload.data;if("undefined"!=typeof f?(f.state=e.entity.header.state,f.code=e.entity.payload.code,f.info=e.entity.payload.info):f={state:e.entity.header.state,code:e.entity.payload.code,info:e.entity.payload.info},0===e.entity.payload.code)a(f);else if(e.entity.payload.code>=1e3&&e.entity.payload.code<=1999)k({content:b.bizSystemMsg,stayTime:b.delayHide,type:"warn"}),d(f);else if(e.entity.payload.code>=3e3&&e.entity.payload.code<=3019){m.remove(b.tokenKey);var g={title:"提示信息",content:b.bizAuthMsg};e.entity.payload.code>=3001&&(g.content=e.entity.payload.info);var h=l(g);h.on("dialog:action",function(a){c.pageForward("login.html",location.href)}),d(f)}else if(0!==e.entity.payload.code){var i=e.entity.payload.info;r.autoTip&&c.notice(i),d(f)}else d(f)}).otherwise(function(a){k("httperror"===a.error?{content:b.cliHttpErrorMsg,stayTime:b.delayHide,type:"warn"}:"timeout"===a.error?{content:b.cliTimeoutMsg,stayTime:b.delayHide,type:"warn"}:"encrypterror"===a.error?{content:b.cryptErrorMsg,stayTime:b.delayHide,type:"warn"}:"signerror"===a.error?{content:b.signErrorMsg,stayTime:b.delayHide,type:"warn"}:{content:b.bizSystemMsg,stayTime:b.delayHide,type:"warn"}),d(a)})})})}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080002",["OBapi"],function(a){var b=function(b){var c={openId:b};return a("IF080002",c)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080004",["OBapi"],function(a){var b=function(b,c){var d={fundAccount:b,billDate:c};return a("IF080004",d)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080007",["OBapi"],function(a){var b=function(b,c,d,e,f){var g={fundAccount:b,fetureExpireDay:c,queryNum:d,queryIndex:e,billDate:f};return a("IF080007",g)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){"use strict";a("IF080008",["OBapi"],function(a){var b=function(b,c,d,e,f){var g={fundAccount:b,fetureExpireDay:c,queryNum:d,queryIndex:e,billDate:f};return a("IF080008",g)};return b})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("marginOrderMainViewModel",["IF080004","IF080007","IF080008"],function(a,b,c){require("deepCopy");when=require("when");var d=[30,60,90],e=0,f=0,g={basicInfo:{fundAccount:"",totalDebtAmt:0,interestFeeDebtAmt:0,dataDate:""},rzData:{fundAccount:[]},rqData:{fundAccount:[]},queryBasicInfo:function(){var b=this;return new a(b.basicInfo.fundAccount,"").then(function(a){return b.basicInfo.totalDebtAmt=a.totalDebtAmt,b.basicInfo.interestFeeDebtAmt=a.interestFeeDebtAmt,when.resolve(a)})},getRzData:function(a){var b=this;(0==b.rzData.fundAccount.length||a)&&b.queryRzOrders(a).then(function(a){b.rzData.fundAccount=a})},getRqData:function(a){var b=this;(0==b.rqData.fundAccount.length||a)&&b.queryRqOrders(a).then(function(a){b.rqData.fundAccount=a})},queryRzOrders:function(a){var c=this;return new b(c.basicInfo.fundAccount,a,"","","").then(function(a){return when.resolve(a)})},queryRqOrders:function(a){var b=this;return new c(b.basicInfo.fundAccount,a,"","","").then(function(a){return when.resolve(a)})},rzDaySelect:function(){e++,e==d.length&&(e=0),$("#rzday").text(d[e]);var a=d[e];this.getRzData(a)},rqDaySelect:function(){f++,f==d.length&&(f=0),$("#rqday").text(d[f]);var a=d[f];this.getRqData(a)}};return{viewModel:g}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("marginOrderViewModel",["IF080002","util","marginOrderMainViewModel"],function(a,b,c){var d="creditBranch",e="noCreditBranch",f={openId:""};return f.pushViewController=function(){return new a(this.openId).then(function(a){return b.isEmpty(a.creditAccount)?a.branch=e:(c.viewModel.basicInfo.fundAccount=a.creditAccount,a.branch=d),a})},{viewModel:f,creditBranch:d,noCreditBranch:e}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("marginOrderMainViewController",["marginOrderMainViewModel"],function(a){var b=require("tabs"),c=require("scroller"),d=require("core"),e=require("dataBinding"),f=(require("blankPage"),document.documentElement.clientHeight),g=document.documentElement.clientWidth,h=function(){var a=$(".ul-moneyInfo").offset().height+100;$("#tab1_content,#tab2_content").height(f-a+"px"),b("#tabOrder",{autoplay:!1}).disable()},i=function(a){var b=$(a),c=b.data("curpage");b.addClass("current").siblings().removeClass("current");var d=c*g+"px";$("#ui-tab-content").css({transform:"translateX(-"+d+")","-webkit-transform":"translateX(-"+d+")"})};return{url:"/",className:"main",render:function(){return $("#tpl_main").html()},bind:function(){var b=c("#tab1_content",{scrollY:!0,bounce:!0,didTriggerToBottom:function(a){var b=this;b.loading(!1)}}),f=c("#tab2_content",{scrollY:!0,bounce:!0,didTriggerToBottom:function(a){var b=this;b.loading(!1)}}),g={"basicInfo.fundAccount":{dom:"#lblFundAccount"},"basicInfo.totalDebtAmt":{dom:"#lblTotalDebtAmt"},"basicInfo.interestFeeDebtAmt":{dom:"#lblInterestFeeDebtAmt"},rzData:{dom:"#rzList",transform:function(a){if(0!=a.fundAccount.length)return a.activedTab="0",a.isHaveMore=!0,d.tpl($("#tpl_listCell").html(),a)},callback:function(){b.refresh(),$("#rz_more").on("tap",function(){location.href="#/list/"+$(this).data("curpage")})}},rqData:{dom:"#rqList",transform:function(a){if(0!=a.fundAccount.length)return a.activedTab="1",a.isHaveMore=!0,d.tpl($("#tpl_listCell").html(),a)},callback:function(){f.refresh(),$("#rq_more").on("tap",function(){location.href="#/list/"+$(this).data("curpage")})}}};e(a.viewModel,g),a.viewModel.queryBasicInfo(),a.viewModel.getRzData(),$("#rzTab,#rqTab").on("tap",function(){$(this).hasClass("current")||(i(this),a.viewModel.getRqData())}),$("#rzTimeSelect,#rqTimeSelect").on("tap",function(){"rzTimeSelect"==this.id?a.viewModel.rzDaySelect():a.viewModel.rqDaySelect()}),h()}}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("marginOrderListViewModel",["marginOrderMainViewModel"],function(a){var b=require("when"),c=[30,60,90],d=0,e=0,f={rzData:{fundAccount:[]},rqData:{fundAccount:[]},getRzData:function(c,d){var e=this;return a.viewModel.queryRzOrders(d).then(function(a){return c||(e.rzData.fundAccount=a),b.resolve(a)})},getRqData:function(c,d){var e=this;return a.viewModel.queryRqOrders(d).then(function(a){return c||(e.rqData.fundAccount=a),b.resolve(a)})},rzDaySelect:function(){d++,d==c.length&&(d=0),$("#rzmday").text(c[d]);var a=c[d];this.getRzData(null,a)},rqDaySelect:function(){e++,e==c.length&&(e=0),$("#rqmday").text(c[e]);var a=c[e];this.getRqData(null,a)}};return{viewModel:f}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),function(a){a("marginOrderListViewController",["marginOrderListViewModel"],function(a){var b=require("tabs"),c=require("scroller"),d=require("dataBinding"),e=require("core"),f=document.documentElement.clientWidth,g=document.documentElement.clientHeight,h=null,i=!1,j=!1,k=function(a,b,c){var d=a?$(a):$($(".mtab")[c]);if(!d.hasClass("current")){d.addClass("current").siblings().removeClass("current");var e=c||a.getAttribute("data-curpage"),g=e*f+"px";$("#"+b).css({transform:"translateX(-"+g+")","-webkit-transform":"translateX(-"+g+")"})}},l=function(a,b,c){if(0!=a.length){var d={isHaveMore:!1,activedTab:b,fundAccount:a},f=e.tpl(document.getElementById("tpl_listCell").innerHTML,d);$(c).append(f)}},m=function(b,c){"0"==b?a.viewModel.getRzData(c).then(function(a){c&&(c(),l(a,"0","#rzmList"))}):"1"==b&&a.viewModel.getRqData(c).then(function(a){c&&(c(),l(a,"1","#rqmList"))})};return{url:"/list/:curpage",className:"list",viewModel:a.viewModel,render:function(){return h=this.params.curpage,$("#tpl_list").html()},bind:function(){b("#tabOrderList",{autoplay:!1}).disable(),$(".mtab").on("tap",function(){k(this,"ui-tab-mcontent")}),$("#tab1_mcontent,#tab2_mcontent").height(g-90+"px");var f=c("#tab1_mcontent",{scrollY:!0,bounce:!0,didTriggerToBottom:function(a){var b=this;i=!0,m("0",function(){b.loading(!1)})}}),l=c("#tab2_mcontent",{scrollY:!0,bounce:!0,didTriggerToBottom:function(a){var b=this;j=!0,m("1",function(){b.loading(!1)})}}),n={rzData:{dom:"#rzmList",transform:function(a){if(0!=a.fundAccount.length)return a.activedTab="0",a.isHaveMore=!1,e.tpl($("#tpl_listCell").html(),a)},callback:function(){f.refresh()}},rqData:{dom:"#rqmList",transform:function(a){if(0!=a.fundAccount.length)return a.activedTab="1",a.isHaveMore=!1,e.tpl($("#tpl_listCell").html(),a)},callback:function(){l.refresh()}}};$("#rzListTab,#rqListTab").on("tap",function(){0!=a.viewModel.rzData.fundAccount.length&&0!=a.viewModel.rqData.fundAccount.length||m($(this).data("curpage"))}),$("#rqmTimeSelect,#rzmTimeSelect").on("tap",function(){"rzmTimeSelect"==this.id?a.viewModel.rzDaySelect():a.viewModel.rqDaySelect()}),d(a.viewModel,n),m(h),k(null,"ui-tab-mcontent",h)}}})}("function"==typeof define&&define.amd?define:function(a){module.exports=a(require)}),require(["domReady","json!config.json","oauthUtil","notificationUtil","marginOrderViewModel","marginOrderMainViewController","marginOrderListViewController"],function(a,b,c,d,e,f,g){var h=require("router"),i=require("blankPage");a(function(){e.viewModel.pushViewController().then(function(a){var c=new h({container:".container",enterTimeout:b.enterTimeout,leaveTimeout:b.leaveTimeout});a.branch==e.creditBranch?c.push(f).push(g).setDefault("/").init():a.branch==e.noCreditBranch}).otherwise(function(a){var b=i({title:a.message});b.on("blankPage:action",function(a){b.remove(),location.reload()})})})}),define("modules/margin/order/viewController",function(){});